<odoo>
    <data noupdate="0">

        <!-- Define all stages first (no forward refs) -->
        <record id="stage_req_received" model="engineering.quotation.stage">
            <field name="name">استقبال الطلب</field>
            <field name="sequence">10</field>
        </record>

        <record id="stage_concept_design" model="engineering.quotation.stage">
            <field name="name">التصميم المبدئي</field>
            <field name="sequence">20</field>
        </record>

        <record id="stage_pricing_review" model="engineering.quotation.stage">
            <field name="name">تسعير ومراجعة</field>
            <field name="sequence">30</field>
        </record>

        <record id="stage_sent_customer" model="engineering.quotation.stage">
            <field name="name">مرسل للعميل</field>
            <field name="sequence">40</field>
        </record>

        <record id="stage_waiting_approval" model="engineering.quotation.stage">
            <field name="name">بانتظار موافقة العميل</field>
            <field name="sequence">50</field>
        </record>

        <record id="stage_approved" model="engineering.quotation.stage">
            <field name="name">مقبول – Approved</field>
            <field name="sequence">60</field>
            <field name="is_approved_stage">True</field>
        </record>

        <record id="stage_rejected" model="engineering.quotation.stage">
            <field name="name">مرفوض / ملغي</field>
            <field name="sequence">70</field>
            <field name="is_rejected_stage">True</field>
        </record>

        <!-- Now set next_stage_id links (all targets exist) -->
        <record id="stage_req_received" model="engineering.quotation.stage">
            <field name="next_stage_id" ref="stage_concept_design"/>
            <field name="button_name">بدء التصميم المبدئي</field>
        </record>

        <record id="stage_concept_design" model="engineering.quotation.stage">
            <field name="next_stage_id" ref="stage_pricing_review"/>
            <field name="button_name">اعتماد التصميم و التسعير</field>
        </record>

        <record id="stage_pricing_review" model="engineering.quotation.stage">
            <field name="next_stage_id" ref="stage_sent_customer"/>
            <field name="button_name">إرسال للعميل</field>
        </record>

        <record id="stage_sent_customer" model="engineering.quotation.stage">
            <field name="next_stage_id" ref="stage_waiting_approval"/>
            <field name="button_name">متابعة موافقة العميل</field>
        </record>

        <record id="stage_waiting_approval" model="engineering.quotation.stage">
            <field name="next_stage_id" ref="stage_approved"/>
            <field name="button_name">موافقة (Approve)</field>
        </record>

    </data>
</odoo>
